---
title: "Nmap: Gu√≠a completa de reconocimiento de redes para principiantes"
date: 2025-05-14
categories: [Ciberseguridad, Reconocimiento]
tags: [nmap, escaneo-puertos, reconocimiento, pentesting, redes, ciberseguridad]
---

**Nmap** (Network Mapper) es la herramienta de reconocimiento de redes m√°s popular del mundo. Es **gratuita, open source y extremadamente poderosa** para descubrir dispositivos, puertos abiertos, servicios en ejecuci√≥n y mucho m√°s.

> üéØ **¬øPor qu√© es importante?** En ciberseguridad, el reconocimiento es el primer paso. Nmap te permite "mapear" una red como un explorador, identificando qu√© hay disponible antes de cualquier acci√≥n.

## üõ†Ô∏è Instalaci√≥n r√°pida

**En Debian/Ubuntu:**
```bash
sudo apt update && sudo apt install nmap
```

**En otras distribuciones:**
```bash
# Fedora/CentOS
sudo dnf install nmap

# Arch Linux
sudo pacman -S nmap
```

**Verificar instalaci√≥n:**
```bash
nmap --version
```

## üéØ Conceptos b√°sicos antes de empezar

### ¬øQu√© hace Nmap?
- **Descubre dispositivos** en una red
- **Identifica puertos abiertos** en esos dispositivos
- **Detecta servicios** corriendo en esos puertos
- **Determina sistemas operativos** aproximados
- **Eval√∫a seguridad** con scripts especializados

### ‚öñÔ∏è Uso √©tico y legal
> ‚ö†Ô∏è **Importante:** Solo usa Nmap en:
> - Tu propia red/dispositivos
> - Redes donde tengas **permiso expl√≠cito**
> - Laboratorios de pr√°ctica legales
> 
> Escanear redes ajenas sin permiso puede ser **ilegal**.

## üöÄ Comandos b√°sicos para principiantes

### 1. Tu primer escaneo
```bash
nmap 192.168.1.1
```
**¬øQu√© hace?** Escanea los 1000 puertos m√°s comunes de esa IP.

**Salida t√≠pica:**
```
Starting Nmap 7.94 ( https://nmap.org )
Nmap scan report for 192.168.1.1
Host is up (0.001s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
443/tcp  open  https
8080/tcp open  http-proxy
```

### 2. Escanear un rango de IPs
```bash
nmap 192.168.1.1-10          # IPs del 1 al 10
nmap 192.168.1.0/24          # Toda la subred (254 IPs)
nmap 192.168.1.1 192.168.1.5 # IPs espec√≠ficas
```

### 3. Escanear puertos espec√≠ficos
```bash
nmap -p 22 192.168.1.1           # Solo puerto 22
nmap -p 22,80,443 192.168.1.1    # Puertos espec√≠ficos
nmap -p 1-100 192.168.1.1        # Rango de puertos
nmap -p- 192.168.1.1             # TODOS los puertos (1-65535)
```

## üîç Tipos de escaneo (para entender qu√© pasa bajo el cap√≥)

### Escaneo TCP SYN (por defecto)
```bash
nmap -sS 192.168.1.1
```
- **M√°s r√°pido** y sigiloso
- No completa la conexi√≥n TCP
- Requiere privilegios root

### Escaneo TCP Connect
```bash
nmap -sT 192.168.1.1
```
- **M√°s lento** pero no requiere root
- Completa la conexi√≥n TCP
- M√°s detectable en logs

### Escaneo UDP
```bash
nmap -sU 192.168.1.1
```
- Escanea puertos UDP
- **M√°s lento** que TCP
- √ötil para servicios como DNS, DHCP

## üìã Detecci√≥n de servicios y versiones

### Detectar versiones de servicios
```bash
nmap -sV 192.168.1.1
```
**Salida ejemplo:**
```
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5
80/tcp   open  http    Apache httpd 2.4.41
443/tcp  open  ssl/http Apache httpd 2.4.41
```

### Detectar sistema operativo
```bash
nmap -O 192.168.1.1
```
**¬øQu√© hace?** Analiza respuestas TCP/IP para adivinar el OS.

### Escaneo con scripts por defecto
```bash
nmap -sC 192.168.1.1
```
**¬øQu√© hace?** Ejecuta scripts de Nmap para detectar vulnerabilidades comunes, informaci√≥n adicional, etc.

### Combo poderoso: Versi√≥n + Scripts + OS
```bash
nmap -sC -sV -O 192.168.1.1
```

## ‚ö° Controlando la velocidad del escaneo

```bash
nmap -T0 192.168.1.1    # Paranoid: MUY lento, sigiloso
nmap -T1 192.168.1.1    # Sneaky: Lento, dif√≠cil de detectar
nmap -T2 192.168.1.1    # Polite: Lento, menos agresivo
nmap -T3 192.168.1.1    # Normal: Velocidad por defecto
nmap -T4 192.168.1.1    # Aggressive: R√°pido, recomendado
nmap -T5 192.168.1.1    # Insane: MUY r√°pido, puede perder info
```

> üí° **Tip:** Para la mayor√≠a de casos, `-T4` es perfecto. Usa `-T1` o `-T2` si necesitas ser sigiloso.

## üéØ Descubrimiento de hosts (¬øqui√©n est√° vivo?)

### Ping scan (solo verificar si est√°n activos)
```bash
nmap -sn 192.168.1.0/24
```
**√ötil para:** Mapear r√°pidamente todos los dispositivos en una red.

### Escaneo espec√≠fico sin ping
```bash
nmap -Pn 192.168.1.1
```
**Cu√°ndo usar:** Cuando el host bloquea pings pero tiene puertos abiertos.

## üìÇ Guardando resultados

### Formato normal (legible)
```bash
nmap -oN escaneo.txt 192.168.1.1
```

### Formato XML (para herramientas)
```bash
nmap -oX escaneo.xml 192.168.1.1
```

### Todos los formatos
```bash
nmap -oA escaneo_completo 192.168.1.1
```
Genera: `escaneo_completo.nmap`, `escaneo_completo.xml`, `escaneo_completo.gnmap`

## üß™ Scripts de Nmap (NSE)

Nmap incluye **m√°s de 600 scripts** para tareas espec√≠ficas:

### Ver scripts disponibles
```bash
ls /usr/share/nmap/scripts/ | grep -i "http"
```

### Ejecutar script espec√≠fico
```bash
nmap --script http-title 192.168.1.1
nmap --script ssh-brute 192.168.1.1
nmap --script vuln 192.168.1.1
```

### Scripts por categor√≠a
```bash
nmap --script "auth" 192.168.1.1      # Scripts de autenticaci√≥n
nmap --script "brute" 192.168.1.1     # Scripts de fuerza bruta
nmap --script "discovery" 192.168.1.1 # Scripts de descubrimiento
nmap --script "vuln" 192.168.1.1      # Scripts de vulnerabilidades
```

## üöÄ Ejemplos pr√°cticos paso a paso

### Escenario 1: Reconocimiento b√°sico de tu red
```bash
# 1. Descubrir dispositivos en tu red local
nmap -sn 192.168.1.0/24

# 2. Escanear un dispositivo espec√≠fico
nmap -T4 -A 192.168.1.1

# 3. Buscar puertos web espec√≠ficos
nmap -p 80,443,8080,8443 192.168.1.0/24
```

### Escenario 2: An√°lisis detallado de un servidor
```bash
# Escaneo completo y profesional
nmap -T4 -A -v --script vuln -oA servidor_scan 192.168.1.100
```
**¬øQu√© hace cada opci√≥n?**
- `-T4`: Velocidad agresiva
- `-A`: Detecci√≥n de OS, versi√≥n, scripts y traceroute
- `-v`: Modo verbose (m√°s informaci√≥n)
- `--script vuln`: Scripts de vulnerabilidades
- `-oA`: Guardar en todos los formatos

### Escenario 3: Buscar servicios espec√≠ficos
```bash
# Buscar servidores web
nmap -p 80,443 --open 192.168.1.0/24

# Buscar servidores SSH
nmap -p 22 --open 192.168.1.0/24

# Buscar servicios de base de datos
nmap -p 3306,5432,1433 --open 192.168.1.0/24
```

## üîß Comando profesional para pentesting

```bash
sudo nmap -p- --open -sS -sC -sV --min-rate 5000 -vvv -n -Pn 192.168.1.100 -oN escaneo_completo
```

**Desglose del comando:**
- `sudo`: Permisos de administrador
- `-p-`: Escanear TODOS los puertos (1-65535)
- `--open`: Mostrar solo puertos abiertos
- `-sS`: Escaneo SYN (sigiloso y r√°pido)
- `-sC`: Scripts por defecto
- `-sV`: Detecci√≥n de versiones
- `--min-rate 5000`: M√≠nimo 5000 paquetes por segundo
- `-vvv`: M√°ximo nivel de detalle
- `-n`: No resolver DNS (m√°s r√°pido)
- `-Pn`: No hacer ping (asumir que est√° activo)
- `-oN`: Guardar resultado en archivo

## üìä Interpretando resultados

### Estados de puertos
- **open**: Puerto abierto y aceptando conexiones
- **closed**: Puerto cerrado pero responde
- **filtered**: Puerto filtrado por firewall
- **unfiltered**: Puerto accesible pero estado indeterminado
- **open|filtered**: Nmap no puede determinar si est√° abierto o filtrado

### Ejemplo de salida completa
```
Nmap scan report for 192.168.1.100
Host is up (0.00043s latency).
Not shown: 65530 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)
80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page
443/tcp  open  ssl/http Apache httpd 2.4.41 ((Ubuntu))
| ssl-cert: Subject: commonName=localhost
```

## üõ°Ô∏è Evasi√≥n b√°sica de firewalls

```bash
# Fragmentar paquetes
nmap -f 192.168.1.1

# Usar se√±uelos (decoy)
nmap -D 192.168.1.5,192.168.1.6,ME 192.168.1.1

# Cambiar puertos source
nmap --source-port 53 192.168.1.1

# Escaneo idle/zombie
nmap -sI zombie_host target_host
```

## üìö Recursos para seguir aprendiendo

### Documentaci√≥n oficial
```bash
man nmap                    # Manual completo
nmap --help                 # Ayuda r√°pida
```

### Libros recomendados
- **"Nmap Network Scanning"** por Gordon Lyon (creador de Nmap)
- **"The Official Nmap Project Guide"**

### Laboratorios de pr√°ctica
- **VulnHub**: M√°quinas virtuales vulnerables
- **HackTheBox**: Plataforma de pentesting legal
- **TryHackMe**: Tutoriales interactivos

---

## üéØ Pr√≥ximos pasos

1. **Practica en tu red local** con dispositivos propios
2. **Combina Nmap con otras herramientas** como Wireshark
3. **Aprende sobre scripts NSE** espec√≠ficos para tus intereses
4. **Estudia evasi√≥n de firewalls** para pentesting avanzado

üí° **Recuerda:** Nmap es solo el primer paso en el reconocimiento. La informaci√≥n que obtengas ser√° la base para todo an√°lisis posterior de seguridad.

---

## üî• Casos de uso profesionales avanzados

### Auditor√≠a de seguridad empresarial

**1. Inventario de activos:**
```bash
# Escaneo completo de la red corporativa
nmap -sn 192.168.0.0/16 > inventario_ips.txt

# Identificar sistemas operativos en la red
nmap -O --osscan-guess 192.168.1.0/24 -oX os_detection.xml

# Buscar servicios cr√≠ticos expuestos
nmap -p 21,22,23,25,53,80,110,443,993,995,1433,3306,3389,5432 --open 192.168.1.0/24
```

**2. Detecci√≥n de vulnerabilidades:**
```bash
# Escaneo completo de vulnerabilidades
nmap --script vuln -sV 192.168.1.100

# Buscar vulnerabilidades espec√≠ficas
nmap --script smb-vuln* 192.168.1.100
nmap --script ssl-* 192.168.1.100
```

### Pentesting y red team

**3. Reconocimiento sigiloso:**
```bash
# Escaneo ultra sigiloso
nmap -sS -T1 -f --randomize-hosts --data-length 25 -D 192.168.1.5,192.168.1.6,ME target

# Usando t√©cnicas de evasi√≥n
nmap --source-port 53 --scan-delay 10s -T1 target
nmap --spoof-mac Apple target
```

**4. Enumeraci√≥n de servicios web:**
```bash
# Enumerar aplicaciones web
nmap --script http-enum -p 80,443,8080,8443 target

# Buscar directorios ocultos
nmap --script http-brute-dirs target

# Identificar tecnolog√≠as web
nmap --script http-waf-detect,http-waf-fingerprint target
```

### An√°lisis forense y incident response

**5. Detecci√≥n de backdoors:**
```bash
# Buscar puertos inusuales abiertos
nmap -p 1-65535 --top-ports 1000 target

# Detectar servicios en puertos no est√°ndar
nmap -sV --version-intensity 9 target
```

**6. Monitoreo continuo:**
```bash
# Script de monitoreo autom√°tico
#!/bin/bash
while true; do
    nmap -sn 192.168.1.0/24 | grep "Nmap scan report" | 
    awk '{print $5}' > current_hosts.txt
    
    if ! diff previous_hosts.txt current_hosts.txt > /dev/null; then
        echo "¬°Cambios detectados en la red!" | mail admin@empresa.com
        cp current_hosts.txt previous_hosts.txt
    fi
    
    sleep 300  # Revisar cada 5 minutos
done
```

## üõ°Ô∏è T√©cnicas avanzadas de evasi√≥n

### Fragmentaci√≥n de paquetes
```bash
# Fragmentar paquetes IP
nmap -f target                    # Fragmentos de 8 bytes
nmap -ff target                   # Fragmentos de 16 bytes
nmap --mtu 24 target             # MTU personalizado (m√∫ltiplo de 8)
```

### Se√±uelos (Decoys)
```bash
# Usar se√±uelos para ocultar origen
nmap -D decoy1,decoy2,decoy3,ME target
nmap -D RND:10 target            # 10 se√±uelos aleatorios
```

### Modificaci√≥n de puertos origen
```bash
# Simular tr√°fico DNS
nmap --source-port 53 target

# Simular tr√°fico web
nmap --source-port 80 target

# Puerto origen aleatorio
nmap -g 1337 target
```

### Timing y velocidad
```bash
# Escaneo extremadamente lento (1 paquete cada 15 segundos)
nmap -T0 --scan-delay 15s target

# Control fino del timing
nmap --min-rate 100 --max-rate 1000 target
nmap --min-parallelism 10 --max-parallelism 50 target
```

## üìä An√°lisis avanzado de resultados

### Parsing autom√°tico con scripts
```bash
#!/bin/bash
# Script para analizar resultados de Nmap

# Extraer solo IPs con puertos abiertos
grep -E "^Nmap scan report|^[0-9]+/tcp.*open" nmap_scan.txt | 
awk '/Nmap scan report/ {ip=$NF} /open/ {print ip":"$1}' > puertos_abiertos.txt

# Crear reporte de servicios vulnerables
nmap -sV --script vulners target -oX scan.xml
xsltproc scan.xml > reporte.html
```

### Integraci√≥n con bases de datos
```python
# Python script para analizar resultados
import xml.etree.ElementTree as ET
import sqlite3

def parse_nmap_xml(xml_file):
    tree = ET.parse(xml_file)
    root = tree.getroot()
    
    conn = sqlite3.connect('scan_results.db')
    cursor = conn.cursor()
    
    cursor.execute('''CREATE TABLE IF NOT EXISTS hosts
                     (ip TEXT, hostname TEXT, status TEXT)''')
    
    cursor.execute('''CREATE TABLE IF NOT EXISTS ports
                     (ip TEXT, port INTEGER, protocol TEXT, 
                      service TEXT, version TEXT)''')
    
    for host in root.findall('host'):
        ip = host.find('address').get('addr')
        status = host.find('status').get('state')
        
        cursor.execute("INSERT INTO hosts VALUES (?, ?, ?)", 
                      (ip, '', status))
        
        ports = host.find('ports')
        if ports is not None:
            for port in ports.findall('port'):
                port_num = port.get('portid')
                protocol = port.get('protocol')
                service = port.find('service')
                
                if service is not None:
                    service_name = service.get('name', '')
                    version = service.get('version', '')
                else:
                    service_name = version = ''
                
                cursor.execute("INSERT INTO ports VALUES (?, ?, ?, ?, ?)",
                              (ip, port_num, protocol, service_name, version))
    
    conn.commit()
    conn.close()

# Uso
parse_nmap_xml('scan_results.xml')
```

## üî¨ Scripts NSE personalizados

### Crear tu propio script NSE
```lua
-- mi-script.nse
local nmap = require "nmap"
local shortport = require "shortport"
local http = require "http"

description = [[
Script personalizado para detectar aplicaciones web espec√≠ficas
]]

author = "Tu Nombre"
license = "Same as Nmap"
categories = {"discovery", "safe"}

-- Definir en qu√© puertos ejecutar
portrule = shortport.http

action = function(host, port)
    local response = http.get(host, port, "/")
    
    if response and response.status == 200 then
        local body = response.body
        
        -- Buscar patrones espec√≠ficos
        if string.match(body, "WordPress") then
            return "WordPress detectado"
        elseif string.match(body, "Joomla") then
            return "Joomla detectado"
        end
    end
    
    return nil
end
```

**Ejecutar script personalizado:**
```bash
nmap --script mi-script.nse target
```

## üéØ Automatizaci√≥n con Nmap

### Script de reconocimiento completo
```bash
#!/bin/bash
# recon.sh - Script de reconocimiento autom√°tico

TARGET=$1
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
OUTPUT_DIR="scan_${TARGET}_${TIMESTAMP}"

mkdir -p $OUTPUT_DIR

echo "[*] Iniciando reconocimiento de $TARGET"

# 1. Ping sweep
echo "[*] Descubrimiento de hosts..."
nmap -sn $TARGET > $OUTPUT_DIR/ping_sweep.txt

# 2. Escaneo de puertos r√°pido
echo "[*] Escaneo r√°pido de puertos..."
nmap -T4 --top-ports 1000 $TARGET -oN $OUTPUT_DIR/quick_scan.txt

# 3. Escaneo completo de puertos abiertos
OPEN_PORTS=$(grep -E "^[0-9]+/tcp.*open" $OUTPUT_DIR/quick_scan.txt | 
             cut -d'/' -f1 | tr '\n' ',' | sed 's/,$//')

if [ ! -z "$OPEN_PORTS" ]; then
    echo "[*] Escaneo detallado de puertos: $OPEN_PORTS"
    nmap -sC -sV -p $OPEN_PORTS $TARGET -oA $OUTPUT_DIR/detailed_scan
fi

# 4. Escaneo de vulnerabilidades
echo "[*] Escaneo de vulnerabilidades..."
nmap --script vuln -p $OPEN_PORTS $TARGET -oN $OUTPUT_DIR/vuln_scan.txt

# 5. Detecci√≥n de OS
echo "[*] Detecci√≥n de sistema operativo..."
nmap -O $TARGET -oN $OUTPUT_DIR/os_detection.txt

echo "[*] Reconocimiento completado. Resultados en: $OUTPUT_DIR"
```

### Monitoreo continuo de red
```bash
#!/bin/bash
# monitor_network.sh - Monitoreo continuo

NETWORK="192.168.1.0/24"
BASELINE_FILE="network_baseline.txt"
ALERT_EMAIL="admin@empresa.com"

# Crear baseline si no existe
if [ ! -f $BASELINE_FILE ]; then
    nmap -sn $NETWORK | grep "Nmap scan report" > $BASELINE_FILE
    echo "Baseline creado: $BASELINE_FILE"
    exit 0
fi

# Escaneo actual
CURRENT_SCAN=$(mktemp)
nmap -sn $NETWORK | grep "Nmap scan report" > $CURRENT_SCAN

# Comparar con baseline
DIFF_OUTPUT=$(diff $BASELINE_FILE $CURRENT_SCAN)

if [ ! -z "$DIFF_OUTPUT" ]; then
    echo "¬°Cambios detectados en la red!"
    echo "$DIFF_OUTPUT"
    
    # Enviar alerta por email (requiere mailutils)
    echo "Cambios detectados en la red $NETWORK:
    
$DIFF_OUTPUT" | mail -s "Alerta de Red" $ALERT_EMAIL
    
    # Actualizar baseline
    cp $CURRENT_SCAN $BASELINE_FILE
fi

rm $CURRENT_SCAN
```

## üìö Recursos adicionales para maestr√≠a

### Laboratorios de pr√°ctica
- **Metasploitable**: VM vulnerable para pr√°ctica
- **DVWA**: Aplicaci√≥n web vulnerable
- **VulnHub**: Colecci√≥n de VMs vulnerables
- **HackTheBox**: Plataforma de pentesting
- **TryHackMe**: Tutoriales interactivos

### Herramientas complementarias
```bash
# Masscan - Escaneo masivo ultra r√°pido
masscan -p1-65535 192.168.1.0/24 --rate=1000

# Unicornscan - Esc√°ner as√≠ncrono
unicornscan -mT 192.168.1.1:1-65535

# Zmap - Internet-wide scanning
zmap -p 22 -o ssh_hosts.txt

# Rustscan - Scanner moderno en Rust
rustscan -a 192.168.1.1 -- -sC -sV
```

### Integraci√≥n con frameworks
```python
# python-nmap integration
import nmap

nm = nmap.PortScanner()
result = nm.scan('192.168.1.1', '22-443')

for host in nm.all_hosts():
    print(f'Host: {host} ({nm[host].hostname()})')
    print(f'State: {nm[host].state()}')
    
    for protocol in nm[host].all_protocols():
        ports = nm[host][protocol].keys()
        for port in ports:
            service = nm[host][protocol][port]
            print(f'Port: {port} - {service["state"]} - {service["name"]}')
```

---

**Andr√©s Nu√±ez**