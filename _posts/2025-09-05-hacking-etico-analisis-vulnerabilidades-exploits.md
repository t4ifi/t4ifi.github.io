---
title: "Hacking √âtico desde 0 - Parte 5: An√°lisis de Vulnerabilidades y Exploits"
date: 2025-09-05 10:00:00 +0100
categories: [Hacking √âtico, Ciberseguridad]
tags: [hacking-etico, pentesting, vulnerabilidades, exploits, cve, nessus, openvas, metasploit]
image:
  path: /assets/img/hacking-etico/vulnerabilidades.jpg
  alt: "An√°lisis de Vulnerabilidades y Exploits"
---

## üéØ Introducci√≥n

¬°Bienvenidos a la **quinta entrega** de nuestra serie "Hacking √âtico desde 0"! Despu√©s de dominar el escaneo de red y enumeraci√≥n, es momento de dar el siguiente paso cr√≠tico: **identificar y analizar vulnerabilidades**.

En este tutorial aprenderemos a usar scanners de vulnerabilidades profesionales, interpretar resultados, buscar exploits y preparar vectores de ataque de manera √©tica y metodol√≥gica.

## üîç ¬øQu√© son las Vulnerabilidades?

Una **vulnerabilidad** es una debilidad en un sistema, aplicaci√≥n o configuraci√≥n que puede ser explotada por un atacante para comprometer la seguridad.

### Tipos de Vulnerabilidades:

- **CVE (Common Vulnerabilities and Exposures)**: Vulnerabilidades conocidas p√∫blicamente
- **Zero-day**: Vulnerabilidades no conocidas p√∫blicamente
- **Configuraci√≥n**: Errores en configuraci√≥n de servicios
- **L√≥gica de aplicaci√≥n**: Fallas en el dise√±o del software
- **Humanas**: Errores del factor humano

### Sistema de Puntuaci√≥n CVSS

```
Severidad CVSS:
- 0.0: None
- 0.1-3.9: Low
- 4.0-6.9: Medium  
- 7.0-8.9: High
- 9.0-10.0: Critical
```

## üõ†Ô∏è Herramientas de An√°lisis de Vulnerabilidades

### 1. OpenVAS - Scanner Gratuito

#### Instalaci√≥n en Kali Linux:

```bash
# Actualizar sistema
sudo apt update && sudo apt upgrade -y

# Instalar OpenVAS
sudo apt install openvas -y

# Configuraci√≥n inicial
sudo gvm-setup

# Verificar instalaci√≥n
sudo gvm-check-setup

# Crear usuario admin
sudo runuser -u _gvm -- gvmd --create-user=admin --password=admin123

# Iniciar servicios
sudo gvm-start

# Acceder via web: https://127.0.0.1:9392
```

#### Configuraci√≥n B√°sica:

```bash
# Actualizar feeds de vulnerabilidades
sudo greenbone-feed-sync --type GVMD_DATA
sudo greenbone-feed-sync --type SCAP
sudo greenbone-feed-sync --type CERT

# Verificar status
sudo gvm-check-setup
```

### 2. Nessus - Scanner Profesional

#### Instalaci√≥n:

```bash
# Descargar desde Tenable (versi√≥n Home es gratuita para 16 IPs)
wget https://www.tenable.com/downloads/api/v1/public/pages/nessus/downloads/[ID]/download?i_agree_to_tenable_license_agreement=true

# Instalar .deb
sudo dpkg -i Nessus-[version]-debian6_amd64.deb

# Iniciar servicio
sudo systemctl start nessusd
sudo systemctl enable nessusd

# Acceder: https://localhost:8834
```

### 3. Nuclei - Scanner Moderno y R√°pido

```bash
# Instalaci√≥n
go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest

# O usando package manager
sudo apt install nuclei

# Actualizar templates
nuclei -update-templates

# Escaneo b√°sico
nuclei -u https://target.com

# Escaneo con severidad espec√≠fica
nuclei -u https://target.com -severity critical,high,medium

# Escaneo masivo desde archivo
nuclei -l targets.txt -o results.txt
```

### 4. Nikto - Scanner Web

```bash
# Instalaci√≥n (viene en Kali)
sudo apt install nikto

# Escaneo b√°sico
nikto -h http://target.com

# Escaneo completo con todos los plugins
nikto -h http://target.com -Plugins @@ALL

# Escaneo con authentication
nikto -h http://target.com -id username:password

# Output a archivo
nikto -h http://target.com -o report.html -Format html
```

## üî¨ Metodolog√≠a de An√°lisis de Vulnerabilidades

### Fase 1: Preparaci√≥n del Target

```bash
#!/bin/bash
# prep_target.sh - Preparaci√≥n de target para scanning

TARGET=$1
SCAN_DIR="vuln_scan_$(date +%Y%m%d_%H%M%S)"

if [ -z "$TARGET" ]; then
    echo "Uso: $0 <target>"
    exit 1
fi

mkdir -p $SCAN_DIR
cd $SCAN_DIR

echo "[+] Preparando escaneo de vulnerabilidades para: $TARGET"

# Crear archivo de target
echo $TARGET > targets.txt

# Port scan r√°pido para identificar servicios
echo "[+] Escaneando puertos abiertos..."
nmap -sS -T4 --top-ports 1000 $TARGET -oN port_scan.txt

# Service detection
echo "[+] Detectando servicios..."
nmap -sV -sC $TARGET -oN service_scan.txt

echo "[+] Preparaci√≥n completa. Directorio: $SCAN_DIR"
```

### Fase 2: Escaneo de Vulnerabilidades

#### Con Nuclei:

```bash
# Templates por categor√≠a
nuclei -u https://target.com -tags cve
nuclei -u https://target.com -tags exposure
nuclei -u https://target.com -tags misconfiguration
nuclei -u https://target.com -tags rce

# Por tecnolog√≠a espec√≠fica
nuclei -u https://target.com -tags apache
nuclei -u https://target.com -tags nginx
nuclei -u https://target.com -tags wordpress

# Workflow completo
nuclei -u https://target.com -w workflows/wordpress-workflow.yaml
```

#### Con Scripts Nmap:

```bash
# Scripts de vulnerabilidades
nmap --script vuln target.com

# Scripts espec√≠ficos por servicio
nmap --script http-vuln-* target.com -p 80,443
nmap --script smb-vuln-* target.com -p 445
nmap --script ssh-vuln-* target.com -p 22

# CVE espec√≠ficos
nmap --script http-vuln-cve2017-5638 target.com
nmap --script smb-vuln-ms17-010 target.com
```

### Fase 3: Verificaci√≥n Manual

```bash
# Verificar SSL/TLS
sslscan target.com
testssl.sh target.com

# Verificar headers de seguridad
curl -I https://target.com
python3 -c "
import requests
import json
r = requests.get('https://target.com')
for header, value in r.headers.items():
    print(f'{header}: {value}')
"

# Verificar tecnolog√≠as web
whatweb target.com
wafw00f target.com
```

## üéØ B√∫squeda y An√°lisis de Exploits

### 1. Searchsploit - Base de Datos Local

```bash
# Actualizar base de datos
sudo searchsploit -u

# Buscar por software/versi√≥n
searchsploit apache 2.4.41
searchsploit openssh 8.2
searchsploit wordpress 5.7

# Buscar por CVE
searchsploit CVE-2021-44228

# Examinar exploit
searchsploit -x exploits/linux/remote/12345.py

# Copiar exploit al directorio actual
searchsploit -m exploits/linux/remote/12345.py
```

### 2. Bases de Datos Online

#### Exploit-DB:

```bash
# Script para buscar en exploit-db
#!/bin/bash
# exploit_search.sh

SEARCH_TERM=$1

if [ -z "$SEARCH_TERM" ]; then
    echo "Uso: $0 <termino_busqueda>"
    exit 1
fi

echo "[+] Buscando exploits para: $SEARCH_TERM"

# Searchsploit local
echo "=== SEARCHSPLOIT LOCAL ==="
searchsploit "$SEARCH_TERM"

# CVE Details (requiere curl/wget)
echo "=== BUSCANDO CVE ==="
curl -s "https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=$SEARCH_TERM" | grep -i CVE
```

#### Metasploit Framework:

```bash
# Buscar exploits en Metasploit
msfconsole -q -x "search $TARGET_SERVICE; exit"

# Buscar por CVE
msfconsole -q -x "search cve:2021-44228; exit"

# Buscar por platform
msfconsole -q -x "search platform:linux; exit"
```

### 3. GitHub y Repositorios

```bash
# Script para buscar exploits en GitHub
#!/bin/bash
# github_exploit_search.sh

VULNERABILITY=$1
API_URL="https://api.github.com/search/repositories"

curl -s "$API_URL?q=$VULNERABILITY+exploit&sort=stars&order=desc" | \
jq -r '.items[] | "\(.name): \(.html_url)"' | head -10
```

## üõ°Ô∏è An√°lisis de Riesgo y Priorizaci√≥n

### Matriz de Riesgo

```python
#!/usr/bin/env python3
# risk_analyzer.py - Analizador de riesgo de vulnerabilidades

import json
import sys

def calculate_risk_score(cvss_score, exploitability, exposure):
    """
    Calcula puntuaci√≥n de riesgo basada en m√∫ltiples factores
    """
    # CVSS base score (0-10)
    cvss_weight = cvss_score * 0.4
    
    # Exploitability (1-5)
    # 1: Te√≥rico, 2: Proof of concept, 3: Funcional, 4: High, 5: Weaponized
    exploit_weight = exploitability * 0.3
    
    # Exposure (1-5)  
    # 1: Interno, 2: Autenticado, 3: Red local, 4: DMZ, 5: Internet
    exposure_weight = exposure * 0.3
    
    total_score = cvss_weight + exploit_weight + exposure_weight
    return min(total_score, 10.0)

def categorize_risk(score):
    """Categoriza el riesgo seg√∫n la puntuaci√≥n"""
    if score >= 9.0:
        return "CR√çTICO"
    elif score >= 7.0:
        return "ALTO"
    elif score >= 4.0:
        return "MEDIO"
    elif score >= 1.0:
        return "BAJO"
    else:
        return "INFORMATIVO"

# Ejemplo de uso
vulnerabilities = [
    {"name": "CVE-2021-44228", "cvss": 10.0, "exploitability": 5, "exposure": 5},
    {"name": "CVE-2021-34527", "cvss": 8.8, "exploitability": 4, "exposure": 3},
    {"name": "Weak SSL Cipher", "cvss": 5.3, "exploitability": 2, "exposure": 4}
]

print("=== AN√ÅLISIS DE RIESGO ===")
for vuln in vulnerabilities:
    risk_score = calculate_risk_score(vuln['cvss'], vuln['exploitability'], vuln['exposure'])
    category = categorize_risk(risk_score)
    print(f"{vuln['name']}: {risk_score:.1f} - {category}")
```

### Template de Reporte de Vulnerabilidades

```markdown
# Reporte de Vulnerabilidad

## Informaci√≥n General
- **CVE**: CVE-YYYY-XXXXX
- **Severidad CVSS**: X.X (ALTA/MEDIA/BAJA)
- **Categor√≠a**: [RCE/SQLi/XSS/etc.]
- **Fecha descubrimiento**: DD/MM/YYYY

## Descripci√≥n T√©cnica
[Descripci√≥n detallada de la vulnerabilidad]

## Sistemas Afectados
- Sistema 1: IP/Hostname - Puerto - Servicio
- Sistema 2: IP/Hostname - Puerto - Servicio

## Evidencia
- Screenshots
- Comandos ejecutados
- Respuestas del sistema

## Impacto
- **Confidencialidad**: [ALTO/MEDIO/BAJO]
- **Integridad**: [ALTO/MEDIO/BAJO]  
- **Disponibilidad**: [ALTO/MEDIO/BAJO]

## Explotabilidad
- **Complejidad de ataque**: [BAJA/MEDIA/ALTA]
- **Vectores de ataque**: [RED/LOCAL/F√çSICO]
- **Interacci√≥n del usuario**: [REQUERIDA/NO REQUERIDA]

## Recomendaciones
1. Parche/Actualizaci√≥n disponible
2. Configuraciones de mitigaci√≥n
3. Controles compensatorios

## Referencias
- [CVE Details](https://cve.mitre.org/)
- [Vendor Advisory](link)
- [Exploit PoC](link)
```

## üß™ Laboratorio Pr√°ctico

### Ejercicio 1: Escaneo con OpenVAS

```bash
# 1. Configurar target en OpenVAS
# 2. Crear nueva tarea de escaneo
# 3. Seleccionar configuraci√≥n "Full and fast"
# 4. Ejecutar escaneo
# 5. Analizar resultados por severidad
```

### Ejercicio 2: Verificaci√≥n Manual con Nmap

```bash
# Ejemplo: Vulnerable a EternalBlue (MS17-010)
nmap --script smb-vuln-ms17-010 192.168.1.100

# Si es vulnerable:
# Nmap scan report for 192.168.1.100
# PORT    STATE SERVICE
# 445/tcp open  microsoft-ds
# |_smb-vuln-ms17-010: VULNERABLE
```

### Ejercicio 3: B√∫squeda de Exploits

```bash
# 1. Identificar versi√≥n de Apache
nmap -sV target.com -p 80

# 2. Buscar exploits conocidos
searchsploit apache 2.4.41

# 3. Verificar CVE asociados
```

## üîß Scripts de Automatizaci√≥n

### Scanner Completo de Vulnerabilidades

```bash
#!/bin/bash
# vuln_scanner.sh - Scanner automatizado de vulnerabilidades

TARGET=$1
OUTPUT_DIR="vuln_scan_$(date +%Y%m%d_%H%M%S)"

if [ -z "$TARGET" ]; then
    echo "Uso: $0 <target>"
    exit 1
fi

mkdir -p $OUTPUT_DIR
cd $OUTPUT_DIR

echo "[+] Iniciando escaneo de vulnerabilidades: $TARGET"

# Escaneo con Nuclei
echo "[+] Ejecutando Nuclei..."
nuclei -u $TARGET -severity critical,high,medium -o nuclei_results.txt

# Escaneo con Nmap NSE
echo "[+] Ejecutando Nmap scripts..."
nmap --script vuln $TARGET -oN nmap_vuln.txt

# Web vulnerability scan
if [[ $TARGET =~ ^https?:// ]]; then
    echo "[+] Ejecutando Nikto..."
    nikto -h $TARGET -o nikto_results.txt
fi

# SSL/TLS analysis
if [[ $TARGET =~ ^https ]]; then
    echo "[+] Analizando SSL/TLS..."
    sslscan ${TARGET#https://} > sslscan_results.txt
fi

# Generate summary
echo "[+] Generando resumen..."
cat > summary.md << EOF
# Resumen de Vulnerabilidades - $TARGET

## Fecha: $(date)

### Herramientas utilizadas:
- Nuclei
- Nmap NSE scripts
- Nikto (si aplicable)
- SSLScan (si aplicable)

### Archivos generados:
- nuclei_results.txt
- nmap_vuln.txt
- nikto_results.txt (si aplicable)
- sslscan_results.txt (si aplicable)

### Pr√≥ximos pasos:
1. Revisar vulnerabilidades cr√≠ticas y altas
2. Verificar manualmente los falsos positivos
3. Buscar exploits disponibles
4. Priorizar por riesgo e impacto
EOF

echo "[+] Escaneo completado. Resultados en: $OUTPUT_DIR"
```

## üìä Interpretaci√≥n de Resultados

### Falsos Positivos Comunes

```bash
# Verificar manualmente vulnerabilidades reportadas
# Ejemplo: XSS reflected

curl -v "http://target.com/search?q=<script>alert(1)</script>"

# Si no se ejecuta el script, es falso positivo
# Si se ejecuta, confirmar vulnerabilidad
```

### Correlaci√≥n de Datos

```python
#!/usr/bin/env python3
# correlate_vulns.py - Correlacionar vulnerabilidades entre herramientas

import re
import json

def parse_nuclei_results(file_path):
    """Parse Nuclei results"""
    vulnerabilities = []
    with open(file_path, 'r') as f:
        for line in f:
            if '[' in line and ']' in line:
                # Extract info from Nuclei output
                match = re.search(r'\[([^\]]+)\] \[([^\]]+)\] ([^\[]+)', line)
                if match:
                    vulnerabilities.append({
                        'severity': match.group(1),
                        'type': match.group(2),
                        'description': match.group(3).strip()
                    })
    return vulnerabilities

def generate_report(nuclei_vulns, nmap_vulns):
    """Generate consolidated report"""
    print("=== REPORTE CONSOLIDADO DE VULNERABILIDADES ===\n")
    
    print("VULNERABILIDADES CR√çTICAS:")
    for vuln in nuclei_vulns:
        if vuln['severity'].lower() == 'critical':
            print(f"- {vuln['description']}")
    
    print("\nVULNERABILIDADES ALTAS:")
    for vuln in nuclei_vulns:
        if vuln['severity'].lower() == 'high':
            print(f"- {vuln['description']}")

# Uso del script ser√≠a llamar las funciones con los archivos de resultados
```

## üéØ Pr√≥ximos Pasos

En el **pr√≥ximo tutorial** de la serie abordaremos:

1. **Explotaci√≥n de Servicios Comunes**
2. **Uso de Metasploit Framework**
3. **Desarrollo de exploits personalizados**
4. **T√©cnicas de escalada de privilegios**
5. **Post-explotaci√≥n b√°sica**

## üìö Recursos Adicionales

- [NIST National Vulnerability Database](https://nvd.nist.gov/)
- [MITRE CVE Database](https://cve.mitre.org/)
- [Exploit Database](https://www.exploit-db.com/)
- [Nuclei Templates](https://github.com/projectdiscovery/nuclei-templates)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)

## üéì Conclusi√≥n

El an√°lisis de vulnerabilidades es un arte que combina herramientas automatizadas con verificaci√≥n manual y criterio profesional. La clave est√° en:

1. **Usar m√∫ltiples herramientas** para cobertura completa
2. **Verificar manualmente** los resultados
3. **Priorizar por riesgo real** no solo por CVSS
4. **Documentar meticulosamente** todos los hallazgos
5. **Mantenerse actualizado** con nuevas vulnerabilidades

Un pentester experimentado no solo encuentra vulnerabilidades, sino que **entiende su impacto real** en el contexto del negocio y puede **comunicar efectivamente** los riesgos a diferentes audiencias.

En la pr√≥xima entrega, ¬°pondremos en pr√°ctica todo lo aprendido y comenzaremos la fase de explotaci√≥n!

---

**Andr√©s Nu√±ez - t4ifi**
